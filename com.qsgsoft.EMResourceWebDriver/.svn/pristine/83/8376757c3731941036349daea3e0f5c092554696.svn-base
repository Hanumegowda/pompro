package requirementGroup.Reports;

import static org.junit.Assert.assertTrue;
import static org.testng.Assert.assertEquals;

import java.io.File;
import java.util.Properties;
import java.util.concurrent.TimeUnit;

import lib.dataObject.Login_data;
import lib.dataObject.Report_data;
import lib.dataObject.ResourceType_data;
import lib.dataObject.Resource_data;
import lib.dataObject.Roles_data;
import lib.dataObject.StatusTypes_data;
import lib.dataObject.User_data;
import lib.dataObject.View_data;
import lib.module.NavigationToSubMenus;
import lib.page.AutoIT;
import lib.page.EventManagement;
import lib.page.Login;
import lib.page.Map;
import lib.page.RegionDefault;
import lib.page.Report;
import lib.page.Resource;
import lib.page.ResourceType;
import lib.page.Roles;
import lib.page.SelectRegion;
import lib.page.StatusTypeList;
import lib.page.UpdateStatus;
import lib.page.UsersList;
import lib.page.ViewsList;

import org.apache.commons.lang3.ArrayUtils;
import org.testng.annotations.Test;

import qaframework.lib.UserDefinedFunctions.Date_Time_settings;
import qaframework.lib.UserDefinedFunctions.OfficeCommonFunctions;
import qaframework.lib.UserDefinedFunctions.PathsProperties;
import qaframework.lib.UserDefinedFunctions.ReadAutoItProperty;
import qaframework.lib.testngExtensions.TestNG_UI_EXTENSIONS;

public class NewStatusSnapshotReport extends TestNG_UI_EXTENSIONS{

	public NewStatusSnapshotReport() throws Exception {
		super();
		// TODO Auto-generated constructor stub
	}
	
	/*******************************************************************************
	'Description : Verify that report can be generated by entering mandatory data.
	'Date	 	 : 25-June-2015
	'Author		 : Anil
	'-------------------------------------------------------------------------------
	'Modified Date			                        	Modified By
	'Date					                            Name
	********************************************************************************/
	@Test(description = "Verify that report can be generated by entering mandatory data.")
	public void testHappyDay3821() throws Exception {

		gstrTCID = "3821";
		gstrTO = "Verify that report can be generated by entering mandatory data.";

		Login_data objTest_data = new Login_data();
		User_data objUser_data = new User_data();
		Resource_data objResource_data = new Resource_data();
		StatusTypes_data objStatuTypes_data = new StatusTypes_data();
		View_data objView_data = new View_data();
		Roles_data objRoles_data = new Roles_data();
		Date_Time_settings objDts = new Date_Time_settings();
		Report_data objReport_data = new Report_data();
		ResourceType_data objResourceType_data = new ResourceType_data();
		StatusTypes_data objStatusTypes_data = new StatusTypes_data();

		PathsProperties objAP = new PathsProperties();
		Properties pathProps = objAP.ReadAutoit_FilePath();
		Date_Time_settings dts = new Date_Time_settings();
		String strPartialAutoResultsPath = Login_data.strPartialAutoResultsPath;
		OfficeCommonFunctions objOffCommonFunc = new OfficeCommonFunctions();

		String strTimeText = dts.getCurrentDate(objReport_data.dateFormat1);
		String fileType = objReport_data.reportFile;

		Login objLogin = new Login(this.driver1);
		SelectRegion objSelectRegion = new SelectRegion(this.driver1);
		RegionDefault objRegionDefault = new RegionDefault(this.driver1);
		StatusTypeList objStatusTypeList = new StatusTypeList(this.driver1);
		ResourceType objResourceType = new ResourceType(this.driver1);
		Resource objResource = new Resource(this.driver1);
		UsersList objUsersList = new UsersList(this.driver1);
		Roles objRoles = new Roles(this.driver1);
		ViewsList objViewsList = new ViewsList(this.driver1);
		NavigationToSubMenus objNavigationToSubMenus = new NavigationToSubMenus(
				this.driver1);

		Login objLogin1 = new Login(this.driver1);
		RegionDefault objRegionDefault1 = new RegionDefault(this.driver1);
		EventManagement objEventManagement1 = new EventManagement(this.driver1);
		NavigationToSubMenus objNavigationToSubMenus1 = new NavigationToSubMenus(
				this.driver1);
		Report objReport1 = new Report(this.driver1);
		ViewsList objViewsList1 = new ViewsList(this.driver1);
		AutoIT objAutoIT = new AutoIT(this.driver1);
		UpdateStatus objUpdateStatus_Page1 = new UpdateStatus(this.driver1);
		
		String strstatusTypeValues[] = new String[6];
		String strResourceValue[] = new String[1];
		String strResourceTypeValue[] = new String[1];
		String strRoleValue[] = new String[1];
		String strStatusesValues[] = new String[1];
		
		// Auto it path
		String AutoIT_FILE_PATH = objReport_data.reportsDownloadAutoItPath;
		String strAutoItPath = ReadAutoItProperty
				.readDataFromAutoItPath(AutoIT_FILE_PATH);
		String strAutoITName = pathProps
				.getProperty(objReport_data.reportsDownloadAutoItName);
		String fileDownloadPath = pathProps
				.getProperty(objReport_data.reportsDownloadPath);
		File file = new File(System.getProperty("user.dir") + fileDownloadPath);
		String strDownloadName = file + "\\" + "TC" +gstrTCID+ "_" + strTimeText
				+ fileType;

		objLogin.loginToApplication(objTest_data.strUserName,
				objTest_data.strPassword);

		objSelectRegion.selectRegionAndNavigate(objTest_data.strRegionName);

		objRegionDefault.selectFrame();

		objStatusTypeList.navigateToStatusTypeList()

		// RoleBased statustypes
				.createStatusType(objStatuTypes_data.strNumberStatusType,
						objStatuTypes_data.strNSTStatusTypeName,
						objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[0] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strTextStatusType,
				objStatuTypes_data.strTSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[1] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strTSTStatusTypeName);

		objStatusTypeList
				.createStatusType(objStatusTypes_data.strMultiStatusType,
						objStatusTypes_data.strMSTStatusTypeName,
						objStatusTypes_data.strStatusDescription)
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti)
						
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti1,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti);		

		strStatusesValues[0] = objStatusTypeList
				.getStatusesValue(objStatuTypes_data.strStatusNameInMulti);

		objStatusTypeList.clickOnReturnToStatusTypeList();

		objStatusTypeList.navigateToStatusTypeListNew();

		strstatusTypeValues[2] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strMSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strSaturationScoreStatusType,
				objStatuTypes_data.strSSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[3] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strSSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strNedocCalculationStatusType,
				objStatuTypes_data.strNDSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[4] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNDSTStatusTypeName);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strDateStatusType,
				objStatuTypes_data.strDateStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[5] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strDateStatusTypeName);

		// Resource type creation
		objResourceType.navigateToResourceTypePage().createResourceType(
				objResourceType_data.strResourceTypeName, strstatusTypeValues);

		strResourceTypeValue[0] = objResourceType
				.getResourceTypeValue(objResourceType_data.strResourceTypeName);

		// create resource with address
		objResource.navigateToResourceListPage().createResourceWithAddress(
				objResource_data.strResourceName,
				objResource_data.strResourceAbbrivation,
				objResourceType_data.strResourceTypeName,
				objResource_data.strStandardResourceTypename,
				objResource_data.strResourceFirstName,
				objResource_data.strResourceLastName,
				objResource_data.strStreetAddress, objResource_data.strCity,
				objResource_data.strState, objResource_data.strCounty,
				objResource_data.strZipcode);

		strResourceValue[0] = objResource
				.getResourceValue(objResource_data.strResourceName);

		// Create role
		objNavigationToSubMenus.navigateToRoles();

		objRoles.createRole(objRoles_data.strRoleName);

		strRoleValue[0] = objRoles.getRoleValue(objRoles_data.strRoleName);

		// create view
		String[] strStatusTypeNames = {
				objStatuTypes_data.strNSTStatusTypeName,
				objStatuTypes_data.strTSTStatusTypeName,
				objStatuTypes_data.strMSTStatusTypeName,
				objStatuTypes_data.strSSTStatusTypeName,
				objStatuTypes_data.strNDSTStatusTypeName,
				objStatuTypes_data.strDateStatusTypeName};

		objNavigationToSubMenus.navigateToViews();

		objViewsList.createView(objView_data.strViewName, objView_data.strViewDesc, objResource_data.strResourceName, strStatusTypeNames);
		
//		objViewsList.clickCreateNewViewButton()
//				.enterViewName(objView_data.strViewName)
//				.enterViewDesc(objView_data.strViewDesc);
//
//		for (int i = 0; i < strStatusTypeNames.length; i++) {
//
//			objViewsList.selectStatusType(strStatusTypeNames[i]);
//		}
//
//		objViewsList.selectResource(objResource_data.strResourceName)
//				.clickOnSaveOfCreateNewView();

		System.out.println(objView_data.strViewName);

		// User creation
		objUsersList
				.navigateToUsersNew()
				.clickCreateNewUserButton()
				.enterUserDetails(objUser_data.strNewUserName,
						objUser_data.strNewPassword, objUser_data.strFullName)
				.selectRoleCheckBox(strRoleValue)
				.clickAdvancedOptionAndExpand()
				.selectReportStatusSnapshotOption()
				.selectViewResourceCheckBox(objResource_data.strResourceName)
				.selectUpdateStatusOfResource(objResource_data.strResourceName)
				.selectRunReportsCheckBox(objResource_data.strResourceName)
				.clickSaveButton()
				.verifyUserListPageIsDisplayed();

		System.out.println(objUser_data.strNewUserName);

		objLogin.clickLogOut();

		System.out
				.println("-----Precondition ends and test execution starts-------");

		objLogin1.loginAsNewUser(objUser_data.strNewUserName,
				objUser_data.strNewPassword);

		objRegionDefault1.selectFrame();

		objNavigationToSubMenus1
				.navigateToParticularViewUnderViewMenu(objView_data.strViewName);

		objViewsList1.clickOnUpdateStatus(objResource_data.strResourceName);

		objUpdateStatus_Page1
				.clickOnSelectAll()
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[0],
						objView_data.strValueForUpdate)
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[1],
						objView_data.strValueForUpdate)
				.enterUpdateSSTValues(strstatusTypeValues[3],
						objView_data.strValueForSST)
				.selectMSTUpdateValue(strstatusTypeValues[2],
						strStatusesValues[0])
				.enterNedocsUpdateValue(strstatusTypeValues[4],
						objView_data.strValueForNDST)
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[5],
						objView_data.strDateUpdateValue).clickOnSaveButton();

		String strUpdatedTime = objEventManagement1.getApplicationTime();

		String strTime[] = strUpdatedTime.split(" ");

		String strTime1 = strTime[0];

		String strTime2 = strTime[1];

		String strTime3 = strTime[2];

		String strDate = dts.timeNow("dd MMM yyyy");

		String strUpdateTime = strTime1 + " " + strTime2 + " " + strDate + " "
				+ strTime3;

		objUpdateStatus_Page1.verifyUpdatedStatusValues(strResourceValue[0],
				strstatusTypeValues[0], objView_data.strValueForUpdate);

		objUpdateStatus_Page1.verifyUpdatedStatusValues(strResourceValue[0],
				strstatusTypeValues[1], objView_data.strValueForUpdate);

		objUpdateStatus_Page1
				.verifyUpdatedStatusValues(strResourceValue[0],
						strstatusTypeValues[2],
						objStatuTypes_data.strStatusNameInMulti);

		objUpdateStatus_Page1.verifyUpdatedStatusValues(strResourceValue[0],
				strstatusTypeValues[3], objView_data.strUpdatedValForSST);

		objUpdateStatus_Page1.verifyUpdatedStatusValues(strResourceValue[0],
				strstatusTypeValues[4], objView_data.strNEDOCValue);

		String strEventStartTime = objEventManagement1.getApplicationTime();

		String strStartTime[] = strEventStartTime.split(":");

		String strStartTime1[] = strStartTime[0].split(" ");

		String strHour = strStartTime1[2];

		String strMinute = strStartTime[1];

		String strCurrentDate = objDts.getCurrentDate("MM/dd/yyyy HH:mm");

		String strStartTime2[] = strCurrentDate.split(" ");

		strCurrentDate = strStartTime2[0];

		objNavigationToSubMenus1.clickOnStatusReports();

		objReport1.clickOnStatusSnapshot().enterReportDate(strCurrentDate)
				.selectHour(strHour).selectMinute(strMinute)
				.clickOnGenerateReportBtn();

		objAutoIT.DownloadTheReports(strAutoItPath, strDownloadName,
				strAutoITName);
		
		File file1 = new File(strDownloadName);
		boolean strReportfile = file1.exists();

		objLogin1.clickLogOut();

		if (strReportfile) {
			String[] strTestDataForExcel = {
					"3821",
					Login_data.strBuildName,
					objUser_data.strNewUserName + "/"
							+ objUser_data.strNewPassword,
					objTest_data.strRegionName,
					objStatuTypes_data.strNSTStatusTypeName,
					objStatuTypes_data.strTSTStatusTypeName + ","
							+ objStatuTypes_data.strMSTStatusTypeName + ", "
							+ objStatuTypes_data.strSSTStatusTypeName + ", "
							+ objStatuTypes_data.strNDSTStatusTypeName +", "
							+ objView_data.strDateUpdateValue,
					objResourceType_data.strResourceTypeName,
					objResource_data.strResourceName,
					"",
					"",
					"",
					"",
					objReport_data.ExternalIP,
					strDownloadName,
					strUpdateTime,
					"",
					objView_data.strValueForUpdate + ", "
							+ objView_data.strValueForUpdate + ", "
							+ objStatuTypes_data.strStatusNameInMulti + ", "
							+ objView_data.strUpdatedValForSST + ", "
							+ objView_data.strNEDOCValue };

			objOffCommonFunc.writeResultData(strTestDataForExcel,
					strPartialAutoResultsPath, "CSVDetails");
		}
		if(strReportfile){
			gstrResult = "PASS";
		}else{
			gstrResult = "FAIL";
		}
	}
	
	/**************************************************************************************************************
	'Description : Update statuses of status types NST (number), MST (multi), TST (text) and SST (saturation score)
	               added at the resource level for a resource RS. Verify that a user with ‘Run Report’ & 'View 
	               Resource' rights on RS and with a role WITH only view right for these status types CAN view
	                these status types in the Status Snapshot report.
	'Date	 	 : 25-June-2015
	'Author		 : Pallavi
	'--------------------------------------------------------------------------------------------------------------
	'Modified Date			                        	Modified By
	'Date					                            Name
	***************************************************************************************************************/
	@Test(description = "Update statuses of status types NST (number), MST (multi), TST (text) and SST (saturation "
			+ "score) added at the resource level for a resource RS. Verify that a user with ‘Run Report’ & 'View "
			+ "Resource' rights on RS and with a role WITH only view right for these status types CAN view these "
			+ "status types in the Status Snapshot report.")
	public void testHappyDay47358() throws Exception {

		gstrTCID = "47358";
		gstrTO = "Update statuses of status types NST (number), MST (multi), TST (text) and SST (saturation score)"
				+ " added at the resource level for a resource RS. Verify that a user with ‘Run Report’ & 'View "
				+ "Resource' rights on RS and with a role WITH only view right for these status types CAN view "
				+ "these status types in the Status Snapshot report.";

		Login_data objTest_data = new Login_data();
		User_data objUser_data = new User_data();
		Resource_data objResource_data = new Resource_data();
		StatusTypes_data objStatuTypes_data = new StatusTypes_data();
		View_data objView_data = new View_data();
		Date_Time_settings objDts = new Date_Time_settings();
		Report_data objReport_data = new Report_data();
		ResourceType_data objResourceType_data = new ResourceType_data();
		StatusTypes_data objStatusTypes_data = new StatusTypes_data();
		Roles_data objRolesData = new Roles_data();
		PathsProperties objAP = new PathsProperties();
		Properties pathProps = objAP.ReadAutoit_FilePath();
		Date_Time_settings dts = new Date_Time_settings();
		String strPartialAutoResultsPath = Login_data.strPartialAutoResultsPath;
		OfficeCommonFunctions objOffCommonFunc = new OfficeCommonFunctions();
		String strTimeText = dts.getCurrentDate(objReport_data.dateFormat1);
		String fileType = objReport_data.reportFile;

		Login objLogin = new Login(this.driver1);
		SelectRegion objSelectRegion = new SelectRegion(this.driver1);
		RegionDefault objRegionDefault = new RegionDefault(this.driver1);
		StatusTypeList objStatusTypeList = new StatusTypeList(this.driver1);
		ResourceType objResourceType = new ResourceType(this.driver1);
		Resource objResource = new Resource(this.driver1);
		Roles objRoles = new Roles(this.driver1);
		UsersList objUsersList = new UsersList(this.driver1);
		NavigationToSubMenus objNavigationToSubMenus = new NavigationToSubMenus(
				this.driver1);

		Login objLogin1 = new Login(this.driver1);
		Map objMap1 = new Map(this.driver1);
		RegionDefault objRegionDefault1 = new RegionDefault(this.driver1);
		EventManagement objEventManagement1 = new EventManagement(this.driver1);
		Report objReport1 = new Report(this.driver1);
		AutoIT objAutoIT = new AutoIT(this.driver1);
		UpdateStatus objUpdateStatus_Page1 = new UpdateStatus(this.driver1);
		NavigationToSubMenus objNavigationToSubMenus1 = new NavigationToSubMenus(
				this.driver1);
		
		String strstatusTypeValues[] = new String[6];
		String strResourceValue[] = new String[1];
		String strResourceTypeValue[] = new String[1];
		String strStatusesValues[] = new String[1];
		String strStatusTypeValues1[] = new String[1];
		String strRoleValue[] = new String[1];
		
		// Auto it path
		String AutoIT_FILE_PATH = objReport_data.reportsDownloadAutoItPath;
		String strAutoItPath = ReadAutoItProperty
				.readDataFromAutoItPath(AutoIT_FILE_PATH);
		String strAutoITName = pathProps
				.getProperty(objReport_data.reportsDownloadAutoItName);
		String fileDownloadPath = pathProps
				.getProperty(objReport_data.reportsDownloadPath);		
		File file = new File(System.getProperty("user.dir") + fileDownloadPath);
		String strDownloadName = file + "\\" + "TC" +gstrTCID+ "_" + strTimeText
				+ fileType;

		objLogin.loginToApplication(objTest_data.strUserName,
				objTest_data.strPassword);

		objSelectRegion.selectRegionAndNavigate(objTest_data.strRegionName);

		objRegionDefault.selectFrame();

		objStatusTypeList.navigateToStatusTypeList()

		// RoleBased statustypes
				.createStatusType(objStatuTypes_data.strNumberStatusType,
						objStatuTypes_data.strNSTStatusTypeName,
						objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[0] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strTextStatusType,
				objStatuTypes_data.strTSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[1] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strTSTStatusTypeName);

		objStatusTypeList
				.createStatusType(objStatusTypes_data.strMultiStatusType,
						objStatusTypes_data.strMSTStatusTypeName,
						objStatusTypes_data.strStatusDescription)
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti)
						
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti1,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti1);

		strStatusesValues[0] = objStatusTypeList
				.getStatusesValue(objStatuTypes_data.strStatusNameInMulti);

		objStatusTypeList.clickOnReturnToStatusTypeList();

//		objStatusTypeList.navigateToStatusTypeListNew();

		strstatusTypeValues[2] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strMSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strSaturationScoreStatusType,
				objStatuTypes_data.strSSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[3] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strSSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strNedocCalculationStatusType,
				objStatuTypes_data.strNDSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[4] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNDSTStatusTypeName);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strDateStatusType,
				objStatuTypes_data.strDateStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[5] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strDateStatusTypeName);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strNumberStatusType,
				objStatuTypes_data.strNSTStatusTypeName1,
				objStatuTypes_data.strStatusDescription);

		strStatusTypeValues1[0] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNSTStatusTypeName1);

		// Resource type creation
		objResourceType.navigateToResourceTypePage().createResourceType(
				objResourceType_data.strResourceTypeName, strStatusTypeValues1);

		strResourceTypeValue[0] = objResourceType
				.getResourceTypeValue(objResourceType_data.strResourceTypeName);

		// create resource with address
		objResource.navigateToResourceListPage().createResourceWithAddress(
				objResource_data.strResourceName,
				objResource_data.strResourceAbbrivation,
				objResourceType_data.strResourceTypeName,
				objResource_data.strStandardResourceTypename,
				objResource_data.strResourceFirstName,
				objResource_data.strResourceLastName,
				objResource_data.strStreetAddress, objResource_data.strCity,
				objResource_data.strState, objResource_data.strCounty,
				objResource_data.strZipcode);

		strResourceValue[0] = objResource
				.getResourceValue(objResource_data.strResourceName);
		
		objResource
				.clickOnStatusTypeLinkInResourcePage(objResource_data.strResourceName);

		objResource.verEditResourceLevelStatusTypesPageisDisplayed();

		objResource.selectStatusType(strstatusTypeValues).clickOnSaveButton();
		
		objNavigationToSubMenus.navigateToRoles();

		objRoles.clickOnCreateNewRoleBtn()
				.enterRoleName(objRolesData.strRoleName)
				.deSelectAllCheckboxInRolesMayViewsec()
				.clickStatusTypeInRoleMayViewSection(strstatusTypeValues)
				.clickOnSaveBtn();

		strRoleValue[0] = objRoles.getRoleValue(objRolesData.strRoleName);
		System.out.println(objRolesData.strRoleName);

		// User creation
		objUsersList
				.navigateToUsersNew()
				.clickCreateNewUserButton()
				.enterUserDetails(objUser_data.strNewUserName,
						objUser_data.strNewPassword, objUser_data.strFullName)
				.selectRoleCheckBox(strRoleValue)
				.clickAdvancedOptionAndExpand()
				.selectReportStatusSnapshotOption()
				.selectViewResourceCheckBox(objResource_data.strResourceName)
				.selectRunReportsCheckBox(objResource_data.strResourceName)
				.clickSaveButton()
				.verifyUserListPageIsDisplayed();
		
		// User creation
		objUsersList
				.navigateToUsersNew()
				.clickCreateNewUserButton()
				.enterUserDetails(objUser_data.strNewUserName1,
						objUser_data.strNewPassword, objUser_data.strFullName1)
				.selectFirstRole()
				.selectViewResourceCheckBox(objResource_data.strResourceName)
				.selectUpdateStatusOfResource(objResource_data.strResourceName)
				.clickSaveButton()
				.verifyUserListPageIsDisplayed();

		System.out.println(objUser_data.strNewUserName);
		
		System.out.println(objUser_data.strNewUserName1);

		objLogin.clickLogOut();

		System.out
				.println("-----Precondition ends and test execution starts-------");

		objLogin1.loginAsNewUser(objUser_data.strNewUserName1,
				objUser_data.strNewPassword);

		objRegionDefault1.selectFrame();

		objNavigationToSubMenus1.navigateToMap();

		objMap1.selectResourceNameInFindResourceDropdown(
				objResource_data.strResourceName)
				.verUpdateStatusInPopupWindow()
				.clickUpdateStatusInPopupWindow();

		objUpdateStatus_Page1
				.clickOnSelectAll()
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[0],
						objView_data.strValueForUpdate)
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[1],
						objView_data.strValueForUpdate)
				.enterUpdateSSTValues(strstatusTypeValues[3],
						objView_data.strValueForSST)
				.selectMSTUpdateValue(strstatusTypeValues[2],
						strStatusesValues[0])
				.enterNedocsUpdateValue(strstatusTypeValues[4],
						objView_data.strValueForNDST)
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[5],
						objView_data.strDateUpdateValue).clickOnSaveButton();

		String strUpdatedTime = objEventManagement1.getApplicationTime();

		String strTime[] = strUpdatedTime.split(" ");

		String strTime1 = strTime[0];

		String strTime2 = strTime[1];

		String strTime3 = strTime[2];

		String strDate = dts.timeNow("dd MMM yyyy");

		String strUpdateTime = strTime1 + " " + strTime2 + " " + strDate + " "
				+ strTime3;

		String strEventStartTime = objEventManagement1.getApplicationTime();

		String strStartTime[] = strEventStartTime.split(":");

		String strStartTime1[] = strStartTime[0].split(" ");

		String strHour = strStartTime1[2];

		String strMinute = strStartTime[1];

		String strCurrentDate = objDts.getCurrentDate("MM/dd/yyyy HH:mm");

		String strStartTime2[] = strCurrentDate.split(" ");

		strCurrentDate = strStartTime2[0];
		
		objLogin1.clickLogOut();
		
		objLogin1.loginAsNewUser(objUser_data.strNewUserName,
				objUser_data.strNewPassword);

		objRegionDefault1.selectFrame();

		objNavigationToSubMenus1.clickOnStatusReports();

		objReport1.clickOnStatusSnapshot().enterReportDate(strCurrentDate)
				.selectHour(strHour).selectMinute(strMinute)
				.clickOnGenerateReportBtn();

		objAutoIT.DownloadTheReports(strAutoItPath, strDownloadName,
				strAutoITName);
		
		File file1 = new File(strDownloadName);
		boolean strReportFile = file1.exists();

		objLogin1.clickLogOut();

		if (strReportFile) {
			String[] strTestDataForExcel = {
					"47358",
					Login_data.strBuildName,
					objUser_data.strNewUserName + "/"
							+ objUser_data.strNewPassword,
					objTest_data.strRegionName,
					objStatuTypes_data.strNSTStatusTypeName,
					objStatuTypes_data.strTSTStatusTypeName + ","
							+ objStatuTypes_data.strMSTStatusTypeName + ", "
							+ objStatuTypes_data.strSSTStatusTypeName + ", "
							+ objStatuTypes_data.strNDSTStatusTypeName +", "
							+ objView_data.strDateUpdateValue,
					objResourceType_data.strResourceTypeName,
					objResource_data.strResourceName,
					"",
					"",
					"",
					"",
					objReport_data.ExternalIP,
					strDownloadName,
					strUpdateTime,
					"",
					objView_data.strValueForUpdate + ", "
							+ objView_data.strValueForUpdate + ", "
							+ objStatuTypes_data.strStatusNameInMulti + ", "
							+ objView_data.strUpdatedValForSST + ", "
							+ objView_data.strNEDOCValue };

			objOffCommonFunc.writeResultData(strTestDataForExcel,
					strPartialAutoResultsPath, "CSVDetails");
		}
		if(strReportFile){
			gstrResult = "PASS";
		}else{
			gstrResult = "FAIL";
		}
	}
	
	/**************************************************************************************************************
	'Description : Update statuses of status types NST (number), MST (multi), TST (text) and SST (saturation score) 
	          added at the resource level for a resource RS. Verify that a user with ‘Run Report’ & 'View Resource'
	               rights on RS and with a role WITHOUT view/update rights for these status types CANNOT view these 
	               status types in the Status Snapshot report.
	'Date	 	 : 25-June-2015
	'Author		 : Pallavi
	'--------------------------------------------------------------------------------------------------------------
	'Modified Date			                        	Modified By
	'Date					                            Name
	***************************************************************************************************************/
	@Test(description = "Update statuses of status types NST (number), MST (multi), TST (text) and SST (saturation score)"
			+ " added at the resource level for a resource RS. Verify that a user with ‘Run Report’ & 'View Resource'"
			+ " rights on RS and with a role WITHOUT view/update rights for these status types CANNOT view these status"
			+ " types in the Status Snapshot report.")
	public void testHappyDay42749() throws Exception {

		gstrTCID = "42749";
		gstrTO = "Update statuses of status types NST (number), MST (multi), TST (text) and SST (saturation score) "
				+ "added at the resource level for a resource RS. Verify that a user with ‘Run Report’ & 'View Resource'"
				+ " rights on RS and with a role WITHOUT view/update rights for these status types CANNOT view these"
				+ " status types in the Status Snapshot report.";

		Login_data objTest_data = new Login_data();
		User_data objUser_data = new User_data();
		Resource_data objResource_data = new Resource_data();
		StatusTypes_data objStatuTypes_data = new StatusTypes_data();
		View_data objView_data = new View_data();
		Date_Time_settings objDts = new Date_Time_settings();
		Report_data objReport_data = new Report_data();
		ResourceType_data objResourceType_data = new ResourceType_data();
		StatusTypes_data objStatusTypes_data = new StatusTypes_data();
		PathsProperties objAP = new PathsProperties();
		Properties pathProps = objAP.ReadAutoit_FilePath();
		Date_Time_settings dts = new Date_Time_settings();
		String strPartialAutoResultsPath = Login_data.strPartialAutoResultsPath;
		OfficeCommonFunctions objOffCommonFunc = new OfficeCommonFunctions();
		String strTimeText = dts.getCurrentDate(objReport_data.dateFormat1);
		String fileType = objReport_data.reportFile;

		Login objLogin = new Login(this.driver1);
		SelectRegion objSelectRegion = new SelectRegion(this.driver1);
		RegionDefault objRegionDefault = new RegionDefault(this.driver1);
		StatusTypeList objStatusTypeList = new StatusTypeList(this.driver1);
		ResourceType objResourceType = new ResourceType(this.driver1);
		Resource objResource = new Resource(this.driver1);
		UsersList objUsersList = new UsersList(this.driver1);

		Login objLogin1 = new Login(this.driver1);
		Map objMap1 = new Map(this.driver1);
		RegionDefault objRegionDefault1 = new RegionDefault(this.driver1);
		EventManagement objEventManagement1 = new EventManagement(this.driver1);
		Report objReport1 = new Report(this.driver1);
		AutoIT objAutoIT = new AutoIT(this.driver1);
		UpdateStatus objUpdateStatus_Page1 = new UpdateStatus(this.driver1);
		NavigationToSubMenus objNavigationToSubMenus1 = new NavigationToSubMenus(
				this.driver1);
		
		String strstatusTypeValues[] = new String[6];
		String strResourceValue[] = new String[1];
		String strResourceTypeValue[] = new String[1];
		String strStatusesValues[] = new String[1];
		String strStatusTypeValues1[] = new String[1];
		
		// Auto it path
		String AutoIT_FILE_PATH = objReport_data.reportsDownloadAutoItPath;
		String strAutoItPath = ReadAutoItProperty
				.readDataFromAutoItPath(AutoIT_FILE_PATH);
		String strAutoITName = pathProps
				.getProperty(objReport_data.reportsDownloadAutoItName);
		String fileDownloadPath = pathProps
				.getProperty(objReport_data.reportsDownloadPath);		
		File file = new File(System.getProperty("user.dir") + fileDownloadPath);
		String strDownloadName = file + "\\" + "TC" +gstrTCID+ "_" + strTimeText
				+ fileType;

		objLogin.loginToApplication(objTest_data.strUserName,
				objTest_data.strPassword);

		objSelectRegion.selectRegionAndNavigate(objTest_data.strRegionName);

		objRegionDefault.selectFrame();

		objStatusTypeList.navigateToStatusTypeList()

		// RoleBased statustypes
				.createStatusType(objStatuTypes_data.strNumberStatusType,
						objStatuTypes_data.strNSTStatusTypeName,
						objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[0] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strTextStatusType,
				objStatuTypes_data.strTSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[1] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strTSTStatusTypeName);

		objStatusTypeList
				.createStatusType(objStatusTypes_data.strMultiStatusType,
						objStatusTypes_data.strMSTStatusTypeName,
						objStatusTypes_data.strStatusDescription)
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti)	
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti1,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti1);

		strStatusesValues[0] = objStatusTypeList
				.getStatusesValue(objStatuTypes_data.strStatusNameInMulti);

		objStatusTypeList.clickOnReturnToStatusTypeList();

		objStatusTypeList.navigateToStatusTypeListNew();

		strstatusTypeValues[2] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strMSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strSaturationScoreStatusType,
				objStatuTypes_data.strSSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[3] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strSSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strNedocCalculationStatusType,
				objStatuTypes_data.strNDSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[4] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNDSTStatusTypeName);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strDateStatusType,
				objStatuTypes_data.strDateStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[5] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strDateStatusTypeName);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strNumberStatusType,
				objStatuTypes_data.strNSTStatusTypeName1,
				objStatuTypes_data.strStatusDescription);

		strStatusTypeValues1[0] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNSTStatusTypeName1);

		// Resource type creation
		objResourceType.navigateToResourceTypePage().createResourceType(
				objResourceType_data.strResourceTypeName, strStatusTypeValues1);

		strResourceTypeValue[0] = objResourceType
				.getResourceTypeValue(objResourceType_data.strResourceTypeName);

		// create resource with address
		objResource.navigateToResourceListPage().createResourceWithAddress(
				objResource_data.strResourceName,
				objResource_data.strResourceAbbrivation,
				objResourceType_data.strResourceTypeName,
				objResource_data.strStandardResourceTypename,
				objResource_data.strResourceFirstName,
				objResource_data.strResourceLastName,
				objResource_data.strStreetAddress, objResource_data.strCity,
				objResource_data.strState, objResource_data.strCounty,
				objResource_data.strZipcode);

		strResourceValue[0] = objResource
				.getResourceValue(objResource_data.strResourceName);
		
		objResource
				.clickOnStatusTypeLinkInResourcePage(objResource_data.strResourceName);

		objResource.verEditResourceLevelStatusTypesPageisDisplayed();

		objResource.selectStatusType(strstatusTypeValues).clickOnSaveButton();

		// User creation
		objUsersList
				.navigateToUsersNew()
				.clickCreateNewUserButton()
				.enterUserDetails(objUser_data.strNewUserName,
						objUser_data.strNewPassword, objUser_data.strFullName)
				.clickAdvancedOptionAndExpand()
				.selectReportStatusSnapshotOption()
				.selectViewResourceCheckBox(objResource_data.strResourceName)
				.selectRunReportsCheckBox(objResource_data.strResourceName)
				.clickSaveButton()
				.verifyUserListPageIsDisplayed();
		
		// User creation
		objUsersList
				.navigateToUsersNew()
				.clickCreateNewUserButton()
				.enterUserDetails(objUser_data.strNewUserName1,
						objUser_data.strNewPassword, objUser_data.strFullName1)
				.selectFirstRole()
				.selectViewResourceCheckBox(objResource_data.strResourceName)
				.selectUpdateStatusOfResource(objResource_data.strResourceName)
				.clickSaveButton()
				.verifyUserListPageIsDisplayed();

		System.out.println(objUser_data.strNewUserName);
		
		System.out.println(objUser_data.strNewUserName1);

		objLogin.clickLogOut();

		System.out
				.println("-----Precondition ends and test execution starts-------");

		objLogin1.loginAsNewUser(objUser_data.strNewUserName1,
				objUser_data.strNewPassword);

		objRegionDefault1.selectFrame();

		objNavigationToSubMenus1.navigateToMap();

		objMap1.selectResourceNameInFindResourceDropdown(
				objResource_data.strResourceName)
				.verUpdateStatusInPopupWindow()
				.clickUpdateStatusInPopupWindow();

		objUpdateStatus_Page1
				.clickOnSelectAll()
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[0],
						objView_data.strValueForUpdate)
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[1],
						objView_data.strValueForUpdate)
				.enterUpdateSSTValues(strstatusTypeValues[3],
						objView_data.strValueForSST)
				.selectMSTUpdateValue(strstatusTypeValues[2],
						strStatusesValues[0])
				.enterNedocsUpdateValue(strstatusTypeValues[4],
						objView_data.strValueForNDST)
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[5],
						objView_data.strDateUpdateValue).clickOnSaveButton();

		String strUpdatedTime = objEventManagement1.getApplicationTime();

		String strTime[] = strUpdatedTime.split(" ");

		String strTime1 = strTime[0];

		String strTime2 = strTime[1];

		String strTime3 = strTime[2];

		String strDate = dts.timeNow("dd MMM yyyy");

		String strUpdateTime = strTime1 + " " + strTime2 + " " + strDate + " "
				+ strTime3;

		String strEventStartTime = objEventManagement1.getApplicationTime();

		String strStartTime[] = strEventStartTime.split(":");

		String strStartTime1[] = strStartTime[0].split(" ");

		String strHour = strStartTime1[2];

		String strMinute = strStartTime[1];

		String strCurrentDate = objDts.getCurrentDate("MM/dd/yyyy HH:mm");

		String strStartTime2[] = strCurrentDate.split(" ");

		strCurrentDate = strStartTime2[0];
		
		objLogin1.clickLogOut();
		
		objLogin1.loginAsNewUser(objUser_data.strNewUserName,
				objUser_data.strNewPassword);

		objRegionDefault1.selectFrame();

		objNavigationToSubMenus1.clickOnStatusReports();

		objReport1.clickOnStatusSnapshot().enterReportDate(strCurrentDate)
				.selectHour(strHour).selectMinute(strMinute)
				.clickOnGenerateReportBtn();

		objAutoIT.DownloadTheReports(strAutoItPath, strDownloadName,
				strAutoITName);
		
		File file1 = new File(strDownloadName);
		boolean strReportFile = file1.exists();

		objLogin1.clickLogOut();

		if (strReportFile) {
			String[] strTestDataForExcel = {
					"42749",
					Login_data.strBuildName,
					objUser_data.strNewUserName + "/"
							+ objUser_data.strNewPassword,
					objTest_data.strRegionName,
					objStatuTypes_data.strNSTStatusTypeName,
					objStatuTypes_data.strTSTStatusTypeName + ","
							+ objStatuTypes_data.strMSTStatusTypeName + ", "
							+ objStatuTypes_data.strSSTStatusTypeName + ", "
							+ objStatuTypes_data.strNDSTStatusTypeName +", "
							+ objView_data.strDateUpdateValue,
					objResourceType_data.strResourceTypeName,
					objResource_data.strResourceName,
					"",
					"",
					"",
					"",
					objReport_data.ExternalIP,
					strDownloadName,
					strUpdateTime,
					"",
					objView_data.strValueForUpdate + ", "
							+ objView_data.strValueForUpdate + ", "
							+ objStatuTypes_data.strStatusNameInMulti + ", "
							+ objView_data.strUpdatedValForSST + ", "
							+ objView_data.strNEDOCValue };

			objOffCommonFunc.writeResultData(strTestDataForExcel,
					strPartialAutoResultsPath, "CSVDetails");
		}
		if(strReportFile){
			gstrResult = "PASS";
		}else{
			gstrResult = "FAIL";
		}
	}
	
	/**************************************************************************************************************
	'Description : Update statuses of private status types NST (number), MST (multi), TST (text) and SST (saturation score) 
					added at the resource level for a resource RS. Verify that a user with ‘Run Report’ & 'View Resource' rights on RS and 
					without any role CAN view these status types in the Status Snapshot report. 
	'Date	 	 : 13-Jul-2015
	'Author		 : Renushree
	'--------------------------------------------------------------------------------------------------------------
	'Modified Date			                        	Modified By
	'Date					                            Name
	***************************************************************************************************************/
	@Test(description = "Update statuses of private status types NST (number), MST (multi), TST (text) and SST (saturation score) "
			+ "added at the resource level for a resource RS. Verify that a user with ‘Run Report’ & 'View Resource' rights on RS and "
			+ "without any role CAN view these status types in the Status Snapshot report. ")
	public void testHappyDay49008() throws Exception {

		gstrTCID = "49008";
		gstrTO = "Update statuses of private status types NST (number), MST (multi), TST (text) and SST (saturation score) "
				+ "added at the resource level for a resource RS. Verify that a user with ‘Run Report’ & 'View Resource' rights on RS and "
				+ "without any role CAN view these status types in the Status Snapshot report. ";

		Login_data objTest_data = new Login_data();
		User_data objUser_data = new User_data();
		Resource_data objResource_data = new Resource_data();
		StatusTypes_data objStatuTypes_data = new StatusTypes_data();
		View_data objView_data = new View_data();
		Date_Time_settings objDts = new Date_Time_settings();
		Report_data objReport_data = new Report_data();
		ResourceType_data objResourceType_data = new ResourceType_data();
		StatusTypes_data objStatusTypes_data = new StatusTypes_data();
		PathsProperties objAP = new PathsProperties();
		Properties pathProps = objAP.ReadAutoit_FilePath();
		OfficeCommonFunctions objOffCommonFunc = new OfficeCommonFunctions();
		String strTimeText = objDts.getCurrentDate(objReport_data.dateFormat1);
		String fileType = objReport_data.reportFile;

		Login objLogin = new Login(this.driver1);
		SelectRegion objSelectRegion = new SelectRegion(this.driver1);
		RegionDefault objRegionDefault = new RegionDefault(this.driver1);
		StatusTypeList objStatusTypeList = new StatusTypeList(this.driver1);
		ResourceType objResourceType = new ResourceType(this.driver1);
		Resource objResource = new Resource(this.driver1);
		UsersList objUsersList = new UsersList(this.driver1);

		Login objLogin1 = new Login(this.driver1);
		Map objMap1 = new Map(this.driver1);
		RegionDefault objRegionDefault1 = new RegionDefault(this.driver1);
		EventManagement objEventManagement1 = new EventManagement(this.driver1);
		Report objReport1 = new Report(this.driver1);
		AutoIT objAutoIT = new AutoIT(this.driver1);
		UpdateStatus objUpdateStatus_Page1 = new UpdateStatus(this.driver1);
		NavigationToSubMenus objNavigationToSubMenus1 = new NavigationToSubMenus(
				this.driver1);
		
		String strstatusTypeValues[] = new String[6];
		String strResourceValue[] = new String[1];
		String strResourceTypeValue[] = new String[1];
		String strStatusesValues[] = new String[1];
		String strStatusTypeValues1[] = new String[1];
		
		// Auto it path
		String AutoIT_FILE_PATH = objReport_data.reportsDownloadAutoItPath;
		String strAutoItPath = ReadAutoItProperty
				.readDataFromAutoItPath(AutoIT_FILE_PATH);
		String strAutoITName = pathProps
				.getProperty(objReport_data.reportsDownloadAutoItName);
		String fileDownloadPath = pathProps
				.getProperty(objReport_data.reportsDownloadPath);		
		File file = new File(System.getProperty("user.dir") + fileDownloadPath);
		
		String autoItFilesPath = pathProps
				.getProperty(objReport_data.autoItPath);
		
		File autoItFiles = new File(System.getProperty("user.dir")
				+ autoItFilesPath);
		String strDownloadName = file + "\\" + "TC" +gstrTCID+ "_" + strTimeText
				+ fileType;

		String strCSVFileNameRenamed = "TC" + gstrTCID + "_" + strTimeText;

		String strCSVDownlRenamedPath = file + "\\" + "TC" + gstrTCID + "_"
				+ strTimeText + objReport_data.xlsFile;

		String strDownloadName1 = file + "\\" + "TC" + gstrTCID + "_"
				+ strTimeText + objReport_data.xlsFile;

		String filePath = file + "\\";

		objLogin.loginToApplication(objTest_data.strUserName,
				objTest_data.strPassword);

		objSelectRegion.selectRegionAndNavigate(objTest_data.strRegionName);

		objRegionDefault.selectFrame();

		objStatusTypeList.navigateToStatusTypeList()

		// RoleBased statustypes
				.createPrivateStatusType(objStatuTypes_data.strNumberStatusType,
						objStatuTypes_data.strNSTStatusTypeName,
						objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[0] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNSTStatusTypeName);

		objStatusTypeList.createPrivateStatusType(
				objStatuTypes_data.strTextStatusType,
				objStatuTypes_data.strTSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[1] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strTSTStatusTypeName);

		objStatusTypeList
				.createPrivateStatusType(objStatusTypes_data.strMultiStatusType,
						objStatusTypes_data.strMSTStatusTypeName,
						objStatusTypes_data.strStatusDescription)
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti)
						
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti1,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti1);

		strStatusesValues[0] = objStatusTypeList
				.getStatusesValue(objStatuTypes_data.strStatusNameInMulti);

		objStatusTypeList.clickOnReturnToStatusTypeList();

//		objStatusTypeList.navigateToStatusTypeListNew();

		strstatusTypeValues[2] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strMSTStatusTypeName);

		objStatusTypeList.createPrivateStatusType(
				objStatuTypes_data.strSaturationScoreStatusType,
				objStatuTypes_data.strSSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[3] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strSSTStatusTypeName);

		objStatusTypeList.createPrivateStatusType(
				objStatuTypes_data.strNedocCalculationStatusType,
				objStatuTypes_data.strNDSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[4] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNDSTStatusTypeName);
		
		objStatusTypeList.createPrivateStatusType(
				objStatuTypes_data.strDateStatusType,
				objStatuTypes_data.strDateStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[5] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strDateStatusTypeName);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strNumberStatusType,
				objStatuTypes_data.strNSTStatusTypeName1,
				objStatuTypes_data.strStatusDescription);

		strStatusTypeValues1[0] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNSTStatusTypeName1);

		// Resource type creation
		objResourceType.navigateToResourceTypePage().createResourceType(
				objResourceType_data.strResourceTypeName, strStatusTypeValues1);

		strResourceTypeValue[0] = objResourceType
				.getResourceTypeValue(objResourceType_data.strResourceTypeName);

		// create resource with address
		objResource.navigateToResourceListPage().createResourceWithAddress(
				objResource_data.strResourceName,
				objResource_data.strResourceAbbrivation,
				objResourceType_data.strResourceTypeName,
				objResource_data.strStandardResourceTypename,
				objResource_data.strResourceFirstName,
				objResource_data.strResourceLastName,
				objResource_data.strStreetAddress, objResource_data.strCity,
				objResource_data.strState, objResource_data.strCounty,
				objResource_data.strZipcode);

		strResourceValue[0] = objResource
				.getResourceValue(objResource_data.strResourceName);
		
		objResource
				.clickOnStatusTypeLinkInResourcePage(objResource_data.strResourceName);

		objResource.verEditResourceLevelStatusTypesPageisDisplayed();

		objResource.selectStatusType(strstatusTypeValues).clickOnSaveButton();

		// User creation
		objUsersList
				.navigateToUsersNew()
				.clickCreateNewUserButton()
				.enterUserDetails(objUser_data.strNewUserName,
						objUser_data.strNewPassword, objUser_data.strFullName)
				.clickAdvancedOptionAndExpand()
				.selectReportStatusSnapshotOption()
				.selectViewResourceCheckBox(objResource_data.strResourceName)
				.selectRunReportsCheckBox(objResource_data.strResourceName)
				.clickSaveButton()
				.verifyUserListPageIsDisplayed();
		
		// User creation
		objUsersList
				.navigateToUsersNew()
				.clickCreateNewUserButton()
				.enterUserDetails(objUser_data.strNewUserName1,
						objUser_data.strNewPassword, objUser_data.strFullName1)
				.selectFirstRole()
				.selectViewResourceCheckBox(objResource_data.strResourceName)
				.selectUpdateStatusOfResource(objResource_data.strResourceName)
				.clickSaveButton()
				.verifyUserListPageIsDisplayed();

		System.out.println(objUser_data.strNewUserName);
		
		System.out.println(objUser_data.strNewUserName1);

		objLogin.clickLogOut();

		System.out
				.println("-----Precondition ends and test execution starts-------");

		objLogin1.loginAsNewUser(objUser_data.strNewUserName1,
				objUser_data.strNewPassword);

		objRegionDefault1.selectFrame();

		objNavigationToSubMenus1.navigateToMap();

		objMap1.selectResourceNameInFindResourceDropdown(
				objResource_data.strResourceName)
				.verUpdateStatusInPopupWindow()
				.clickUpdateStatusInPopupWindow();

		objUpdateStatus_Page1
				.clickOnSelectAll()
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[0],
						objView_data.strValueForUpdate)
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[1],
						objView_data.strValueForUpdate)
				.enterUpdateSSTValues(strstatusTypeValues[3],
						objView_data.strValueForSST)
				.selectMSTUpdateValue(strstatusTypeValues[2],
						strStatusesValues[0])
				.enterNedocsUpdateValue(strstatusTypeValues[4],
						objView_data.strValueForNDST)
				.enterNSTAndTSTUpdateValue(strstatusTypeValues[5],
						objView_data.strDateUpdateValue).clickOnSaveButton();

		String strEventStartTime = objEventManagement1.getApplicationTimeWithCSTCDT();

		String strStartTime[] = strEventStartTime.split(":");
		
		String strTimeZone[] = strStartTime[1].split(" ");

		String strStartTime1[] = strStartTime[0].split(" ");

		String strDate2 = strStartTime1[0];

		String strMonth = strStartTime1[1];

		strMonth = objDts
				.converDateFormat(strMonth, "MMM", "MM");

		String strYear = objDts.getFutureYear(0, "yyyy");

		String strHour = strStartTime1[2];

		String strMinute = strStartTime[1];

		String strMinute1 = objDts.addTimetoExisting(strMinute,
				1, "mm");

		String strCurrentDate = strMonth + "/" + strDate2 + "/" + strYear;

		String strTime = objDts.getCurrentDate("HH:mm");

		strCurrentDate = strCurrentDate + " " + strTime;

		String[] strDate = strCurrentDate.split(" ");

		System.out.println(strCurrentDate);
		String strLastUpdatedDateInReport = objDts
				.converDateFormat(strCurrentDate, "MM/dd/yyyy HH:mm",
						"dd MMM yyyy HH:mm");
		String str[] = strLastUpdatedDateInReport.split(" ");
		strLastUpdatedDateInReport = str[0] + " " + str[1] + " " + str[2] + " "
				+ strHour + ":" + strMinute;
		System.out.println(strLastUpdatedDateInReport);
		
		objLogin1.clickLogOut();
		
		objLogin1.loginAsNewUser(objUser_data.strNewUserName,
				objUser_data.strNewPassword);

		objRegionDefault1.selectFrame();

		Thread.sleep(60000);
		
		objNavigationToSubMenus1.clickOnStatusReports();
		
		objReport1.clickOnStatusSnapshot().enterReportDate(strDate[0])
				.selectHour(strHour).selectMinute(strMinute1)
				.clickOnGenerateReportBtn();

		objAutoIT.DownloadTheReports(strAutoItPath, strDownloadName,
				strAutoITName);
		
		int intCount = 0;
		int intCount1 = 0;
		do {

			try {
				assertTrue(new File(strDownloadName).exists());
				Thread.sleep(10000);
				Runtime.getRuntime().exec(
						"wscript " + autoItFiles + filePath + " "
								+ strCSVFileNameRenamed);

				intCount1 = 0;
				do {
					try {
						assertTrue(new File(strCSVDownlRenamedPath).exists());
						break;
					} catch (AssertionError Ae) {
						Thread.sleep(1000);
						intCount1++;
					}

				} while (intCount1 < 60);

				break;
			} catch (AssertionError Ae) {
				Thread.sleep(1000);
				intCount++;
			}
		} while (intCount < 60);

		String strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 1,
				1, strDownloadName1);
		assertEquals("Status Snapshot - " + strDate[0] + " " + strHour + ":"
				+ strMinute1 + " "+strTimeZone[1]+"", strValue);

		String[] strHeaderNames = objReport_data.strStatusSnapshot;

		String[] strAnswers = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatuTypes_data.strDateStatusTypeName,
				objView_data.strDateUpdateValue, "", strLastUpdatedDateInReport };

		for (intCount = 1; intCount <= strHeaderNames.length; intCount++) {
			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 2,
					intCount, strDownloadName1);
			assertEquals(strHeaderNames[intCount - 1], strValue);

			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 3,
					intCount, strDownloadName1);
			assertTrue(strAnswers[intCount - 1].contains(strValue));
		}
		
		String[] strAnswers1 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatusTypes_data.strMSTStatusTypeName,
				objStatusTypes_data.strStatusNameInMulti, "", strLastUpdatedDateInReport };

		for (intCount = 1; intCount <= strHeaderNames.length; intCount++) {
			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 2,
					intCount, strDownloadName1);
			assertEquals(strHeaderNames[intCount - 1], strValue);

			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 4,
					intCount, strDownloadName1);
			assertTrue(strAnswers1[intCount - 1].contains(strValue));
		}
		
		String[] strAnswers2 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatusTypes_data.strNDSTStatusTypeName,
				objView_data.strNEDOCVal, "", strLastUpdatedDateInReport };

		for (intCount = 1; intCount <= strHeaderNames.length; intCount++) {
			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 2,
					intCount, strDownloadName1);
			assertEquals(strHeaderNames[intCount - 1], strValue);

			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 5,
					intCount, strDownloadName1);
			assertTrue(strAnswers2[intCount - 1].contains(strValue));
		}
		
		String[] strAnswers3 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatusTypes_data.strNSTStatusTypeName,
				objView_data.strValueForUpdate, "", strLastUpdatedDateInReport };

		for (intCount = 1; intCount <= strHeaderNames.length; intCount++) {
			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 2,
					intCount, strDownloadName1);
			assertEquals(strHeaderNames[intCount - 1], strValue);

			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 6,
					intCount, strDownloadName1);
			assertTrue(strAnswers3[intCount - 1].contains(strValue));
		}
		
		String[] strAnswers4 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatusTypes_data.strSSTStatusTypeName,
				objView_data.strUpdatedValForSST, "", strLastUpdatedDateInReport };

		for (intCount = 1; intCount <= strHeaderNames.length; intCount++) {
			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 2,
					intCount, strDownloadName1);
			assertEquals(strHeaderNames[intCount - 1], strValue);

			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 7,
					intCount, strDownloadName1);
			assertTrue(strAnswers4[intCount - 1].contains(strValue));
		}
		
		String[] strAnswers5 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatusTypes_data.strTSTStatusTypeName,
				objView_data.strValueForUpdate, "", strLastUpdatedDateInReport };

		for (intCount = 1; intCount <= strHeaderNames.length; intCount++) {
			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 2,
					intCount, strDownloadName1);
			assertEquals(strHeaderNames[intCount - 1], strValue);

			strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", 8,
					intCount, strDownloadName1);
			assertTrue(strAnswers5[intCount - 1].contains(strValue));
		}

		gstrResult = "PASS";
	}
	
	/**************************************************************************************************************
	'Description : Verify that 'Status Snapshot Report' does not display status type for a particular resource for which it is refined. 
	'Date	 	 : 14-Jul-2015
	'Author		 : Renushree
	'--------------------------------------------------------------------------------------------------------------
	'Modified Date			                        	Modified By
	'Date					                            Name
	***************************************************************************************************************/
	@Test(description = "Verify that 'Status Snapshot Report' does not display status type for a particular resource for which it is refined. ")
	public void testHappyDay63459() throws Exception {

		gstrTCID = "63459";
		gstrTO = "Verify that 'Status Snapshot Report' does not display status type for a particular resource for which it is refined. ";

		Login_data objTest_data = new Login_data();
		User_data objUser_data = new User_data();
		Resource_data objResource_data = new Resource_data();
		StatusTypes_data objStatuTypes_data = new StatusTypes_data();
		View_data objView_data = new View_data();
		Date_Time_settings objDts = new Date_Time_settings();
		Report_data objReport_data = new Report_data();
		ResourceType_data objResourceType_data = new ResourceType_data();
		StatusTypes_data objStatusTypes_data = new StatusTypes_data();
		PathsProperties objAP = new PathsProperties();
		Properties pathProps = objAP.ReadAutoit_FilePath();
		OfficeCommonFunctions objOffCommonFunc = new OfficeCommonFunctions();
		String strTimeText = objDts.getCurrentDate(objReport_data.dateFormat1);
		String fileType = objReport_data.reportFile;

		Login objLogin = new Login(this.driver1);
		SelectRegion objSelectRegion = new SelectRegion(this.driver1);
		RegionDefault objRegionDefault = new RegionDefault(this.driver1);
		StatusTypeList objStatusTypeList = new StatusTypeList(this.driver1);
		ResourceType objResourceType = new ResourceType(this.driver1);
		Resource objResource = new Resource(this.driver1);
		UsersList objUsersList = new UsersList(this.driver1);

		Login objLogin1 = new Login(this.driver1);
		Map objMap1 = new Map(this.driver1);
		RegionDefault objRegionDefault1 = new RegionDefault(this.driver1);
		EventManagement objEventManagement1 = new EventManagement(this.driver1);
		Report objReport1 = new Report(this.driver1);
		AutoIT objAutoIT = new AutoIT(this.driver1);
		UpdateStatus objUpdateStatus_Page1 = new UpdateStatus(this.driver1);
		NavigationToSubMenus objNavigationToSubMenus1 = new NavigationToSubMenus(
				this.driver1);
		UsersList objUsersList1 = new UsersList(this.driver1);
		
		String strStatusTypeValues[] = new String[6];
		String strStatusTypeValues1[] = new String[6];
		String strStatusTypeValues2[] = new String[6];
		String strResourceValue[] = new String[2];
		String strResourceTypeValue[] = new String[1];
		String strStatusesValues[] = new String[3];
		
		// Auto it path
		String AutoIT_FILE_PATH = objReport_data.reportsDownloadAutoItPath;
		String strAutoItPath = ReadAutoItProperty
				.readDataFromAutoItPath(AutoIT_FILE_PATH);
		String strAutoITName = pathProps
				.getProperty(objReport_data.reportsDownloadAutoItName);
		String fileDownloadPath = pathProps
				.getProperty(objReport_data.reportsDownloadPath);		
		File file = new File(System.getProperty("user.dir") + fileDownloadPath);
		
		String autoItFilesPath = pathProps
				.getProperty(objReport_data.autoItPath);
		
		File autoItFiles = new File(System.getProperty("user.dir")
				+ autoItFilesPath);
		String strDownloadName = file + "\\" + "TC" +gstrTCID+ "_" + strTimeText
				+ fileType;

		String strCSVFileNameRenamed = "TC" + gstrTCID + "_" + strTimeText;

		String strCSVDownlRenamedPath = file + "\\" + "TC" + gstrTCID + "_"
				+ strTimeText + objReport_data.xlsFile;

		String strDownloadName1 = file + "\\" + "TC" + gstrTCID + "_"
				+ strTimeText + objReport_data.xlsFile;

		String filePath = file + "\\";

		objLogin.loginToApplication(objTest_data.strUserName,
				objTest_data.strPassword);

		objSelectRegion.selectRegionAndNavigate(objTest_data.strRegionName);

		objRegionDefault.selectFrame();

		objStatusTypeList.navigateToStatusTypeList()

		// RoleBased statustypes
				.createStatusType(objStatuTypes_data.strNumberStatusType,
						objStatuTypes_data.strNSTStatusTypeName,
						objStatuTypes_data.strStatusDescription);

		strStatusTypeValues[0] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNSTStatusTypeName);
		
		System.out.println(objStatuTypes_data.strNSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strTextStatusType,
				objStatuTypes_data.strTSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strStatusTypeValues[1] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strTSTStatusTypeName);

		objStatusTypeList
				.createStatusType(objStatusTypes_data.strMultiStatusType,
						objStatusTypes_data.strMSTStatusTypeName,
						objStatusTypes_data.strStatusDescription)
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti)
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti1,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti1);

		strStatusesValues[0] = objStatusTypeList
				.getStatusesValue(objStatuTypes_data.strStatusNameInMulti);

		objStatusTypeList.clickOnReturnToStatusTypeList();

		objStatusTypeList.navigateToStatusTypeListNew();

		strStatusTypeValues[2] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strMSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strSaturationScoreStatusType,
				objStatuTypes_data.strSSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strStatusTypeValues[3] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strSSTStatusTypeName);

		objStatusTypeList.createStatusType(
				objStatuTypes_data.strNedocCalculationStatusType,
				objStatuTypes_data.strNDSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strStatusTypeValues[4] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNDSTStatusTypeName);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strDateStatusType,
				objStatuTypes_data.strDateStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strStatusTypeValues[5] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strDateStatusTypeName);
		
		
		
		
		objStatusTypeList.createStatusType(objStatuTypes_data.strNumberStatusType,
				objStatuTypes_data.strNSTStatusTypeName1,
				objStatuTypes_data.strStatusDescription);

		strStatusTypeValues1[0] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNSTStatusTypeName1);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strTextStatusType,
				objStatuTypes_data.strTSTStatusTypeName1,
				objStatuTypes_data.strStatusDescription);
		
		strStatusTypeValues1[1] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strTSTStatusTypeName1);
		
		objStatusTypeList
				.createStatusType(objStatusTypes_data.strMultiStatusType,
						objStatusTypes_data.strMSTStatusTypeName1,
						objStatusTypes_data.strStatusDescription)
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti1,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti1)
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti2,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti2);
		
		strStatusesValues[1] = objStatusTypeList
				.getStatusesValue(objStatuTypes_data.strStatusNameInMulti1);
		
		objStatusTypeList.clickOnReturnToStatusTypeList();
		
		objStatusTypeList.navigateToStatusTypeListNew();
		
		strStatusTypeValues1[2] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strMSTStatusTypeName1);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strSaturationScoreStatusType,
				objStatuTypes_data.strSSTStatusTypeName1,
				objStatuTypes_data.strStatusDescription);
		
		strStatusTypeValues1[3] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strSSTStatusTypeName1);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strNedocCalculationStatusType,
				objStatuTypes_data.strNDSTStatusTypeName1,
				objStatuTypes_data.strStatusDescription);
		
		strStatusTypeValues1[4] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNDSTStatusTypeName1);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strDateStatusType,
				objStatuTypes_data.strDateStatusTypeName1,
				objStatuTypes_data.strStatusDescription);
		
		strStatusTypeValues1[5] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strDateStatusTypeName1);
		
		objStatusTypeList.createStatusType(objStatuTypes_data.strNumberStatusType,
				objStatuTypes_data.strNSTStatusTypeName2,
				objStatuTypes_data.strStatusDescription);

		strStatusTypeValues2[0] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNSTStatusTypeName2);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strTextStatusType,
				objStatuTypes_data.strTSTStatusTypeName2,
				objStatuTypes_data.strStatusDescription);
		
		strStatusTypeValues2[1] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strTSTStatusTypeName2);
		
		objStatusTypeList
				.createStatusType(objStatusTypes_data.strMultiStatusType,
						objStatusTypes_data.strMSTStatusTypeName2,
						objStatusTypes_data.strStatusDescription)
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti2,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti2)
				.createNewStatus(objStatusTypes_data.strStatusNameInMulti1,
						objStatusTypes_data.strStatusColor)
				.verCreatedStatusInStatusListForMulti(
						objStatusTypes_data.strStatusNameInMulti1);
		
		strStatusesValues[2] = objStatusTypeList
				.getStatusesValue(objStatuTypes_data.strStatusNameInMulti2);
		
		objStatusTypeList.clickOnReturnToStatusTypeList();
		
		objStatusTypeList.navigateToStatusTypeListNew();
		
		strStatusTypeValues2[2] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strMSTStatusTypeName2);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strSaturationScoreStatusType,
				objStatuTypes_data.strSSTStatusTypeName2,
				objStatuTypes_data.strStatusDescription);
		
		strStatusTypeValues2[3] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strSSTStatusTypeName2);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strNedocCalculationStatusType,
				objStatuTypes_data.strNDSTStatusTypeName2,
				objStatuTypes_data.strStatusDescription);
		
		strStatusTypeValues2[4] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNDSTStatusTypeName2);
		
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strDateStatusType,
				objStatuTypes_data.strDateStatusTypeName2,
				objStatuTypes_data.strStatusDescription);
		
		strStatusTypeValues2[5] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strDateStatusTypeName2);
	
		String strTwoSTValues[] = ArrayUtils.addAll(strStatusTypeValues, strStatusTypeValues1);
		
		// Resource type creation
		objResourceType.navigateToResourceTypePage().createResourceType(
				objResourceType_data.strResourceTypeName, strTwoSTValues);

		strResourceTypeValue[0] = objResourceType
				.getResourceTypeValue(objResourceType_data.strResourceTypeName);

		// create resource with address
		objResource.navigateToResourceListPage().createResourceWithAddress(
				objResource_data.strResourceName,
				objResource_data.strResourceAbbrivation,
				objResourceType_data.strResourceTypeName,
				objResource_data.strStandardResourceTypename,
				objResource_data.strResourceFirstName,
				objResource_data.strResourceLastName,
				objResource_data.strStreetAddress, objResource_data.strCity,
				objResource_data.strState, objResource_data.strCounty,
				objResource_data.strZipcode);

		strResourceValue[0] = objResource
				.getResourceValue(objResource_data.strResourceName);
		
		System.out.println(objResource_data.strResourceName);
		
		objResource
		.clickOnStatusTypeLinkInResourcePage(objResource_data.strResourceName);

		objResource.verEditResourceLevelStatusTypesPageisDisplayed();
		
		objResource.selectStatusType(strStatusTypeValues2).clickOnSaveButton();

		// create resource with address
		objResource.createResourceWithAddress(
				objResource_data.strResourceName1,
				objResource_data.strResourceAbbrivation,
				objResourceType_data.strResourceTypeName,
				objResource_data.strStandardResourceTypename,
				objResource_data.strResourceFirstName,
				objResource_data.strResourceLastName,
				objResource_data.strStreetAddress, objResource_data.strCity,
				objResource_data.strState, objResource_data.strCounty,
				objResource_data.strZipcode);

		strResourceValue[1] = objResource
				.getResourceValue(objResource_data.strResourceName1);
		
		objResource
		.clickOnStatusTypeLinkInResourcePage(objResource_data.strResourceName1);

		objResource.verEditResourceLevelStatusTypesPageisDisplayed();
		
		objResource.selectStatusType(strStatusTypeValues2).clickOnSaveButton();
		
		// User creation
		objUsersList
				.navigateToUsersNew()
				.clickCreateNewUserButton()
				.enterUserDetails(objUser_data.strNewUserName,
						objUser_data.strNewPassword, objUser_data.strFullName)
				.selectFirstRole()
				.clickAdvancedOptionAndExpand()
				.selectReportStatusSnapshotOption()
				.selectUpdateStatusOfResource(objResource_data.strResourceName)
				.selectRunReportsCheckBox(objResource_data.strResourceName)
				.selectRunReportsCheckBox(objResource_data.strResourceName1)
				.clickSaveButton()
				.verifyUserListPageIsDisplayed();
		
		System.out.println(objUser_data.strNewUserName);
		
		// User creation
		objUsersList
				.navigateToUsersNew()
				.clickCreateNewUserButton()
				.enterUserDetails(objUser_data.strNewUserName1,
						objUser_data.strNewPassword, objUser_data.strFullName1)
				.selectFirstRole()
				.selectUpdateStatusOfResource(objResource_data.strResourceName)
				.selectUpdateStatusOfResource(objResource_data.strResourceName1)
				.clickAdvancedOptionAndExpand()
				.selectConfigureRegionalUserAccessOption()
				.clickSaveButton()
				.verifyUserListPageIsDisplayed();

		System.out.println(objUser_data.strNewUserName);
		
		System.out.println(objUser_data.strNewUserName1);

		objLogin.clickLogOut();
		
		objLogin1.loginAsNewUser(objUser_data.strNewUserName1,
						objUser_data.strNewPassword);
		
		objRegionDefault1.selectFrame();
		
		objNavigationToSubMenus1.navigateToMap();
		
		objMap1.selectResourceNameInFindResourceDropdown(objResource_data.strResourceName)
		.clickUpdateStatusInPopupWindow();
		
		objUpdateStatus_Page1.clickOnSelectAll()
		.enterNSTAndTSTUpdateValue(strStatusTypeValues[0],
				objView_data.strValueForUpdate)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues[1],
				objView_data.strValueForUpdate)
		.enterUpdateSSTValues(strStatusTypeValues[3],
				objView_data.strValueForSST)
		.selectMSTUpdateValue(strStatusTypeValues[2],
				strStatusesValues[0])
		.enterNedocsUpdateValue(strStatusTypeValues[4],
				objView_data.strValueForNDST)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues[5],
				objView_data.strDateUpdateValue)
				
		.enterNSTAndTSTUpdateValue(strStatusTypeValues1[0],
				objView_data.strValueForUpdate1)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues1[1],
				objView_data.strValueForUpdate1)
		.enterUpdateSSTValues(strStatusTypeValues1[3],
				objView_data.strValueForSST1)
		.selectMSTUpdateValue(strStatusTypeValues1[2],
				strStatusesValues[1])
		.enterNedocsUpdateValue(strStatusTypeValues1[4],
				objView_data.strValueForNDST1)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues1[5],
				objView_data.strDateUpdateFutureValue)
				
		.enterNSTAndTSTUpdateValue(strStatusTypeValues2[0],
				objView_data.strValueForUpdate2)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues2[1],
				objView_data.strValueForUpdate2)
		.enterUpdateSSTValues(strStatusTypeValues2[3],
				objView_data.strValueForSST2)
		.selectMSTUpdateValue(strStatusTypeValues2[2],
				strStatusesValues[2])
		.enterNedocsUpdateValue(strStatusTypeValues2[4],
				objView_data.strValueForNDST2)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues2[5],
				objView_data.strDateUpdateFutureValue1).clickOnSaveButton();
		
		String strEventStartTime = objEventManagement1.getApplicationTimeWithCSTCDT();

		String strStartTime[] = strEventStartTime.split(":");
		
		String strTimeZone[] = strStartTime[1].split(" ");

		String strStartTime1[] = strStartTime[0].split(" ");

		String strDate2 = strStartTime1[0];

		String strMonth = strStartTime1[1];

		strMonth = objDts
				.converDateFormat(strMonth, "MMM", "MM");

		String strYear = objDts.getFutureYear(0, "yyyy");

		String strHour = strStartTime1[2];

		String strMinute = strStartTime[1];
		
		String strMinu[] = strMinute.split(" ");

		String strCurrentDate = strMonth + "/" + strDate2 + "/" + strYear;

		String strTime = objDts.getCurrentDate("HH:mm");

		strCurrentDate = strCurrentDate + " " + strTime;

		String[] strDate = strCurrentDate.split(" ");

		System.out.println(strCurrentDate);
		String strLastUpdatedDateInReport = objDts
				.converDateFormat(strCurrentDate, "MM/dd/yyyy HH:mm",
						"dd MMM yyyy HH:mm");
		String str[] = strLastUpdatedDateInReport.split(" ");
		strLastUpdatedDateInReport = str[0] + " " + str[1] + " " + str[2] + " "
				+ strHour + ":" + strMinu[0];
		System.out.println(strLastUpdatedDateInReport);
		
		objMap1.selectResourceNameInFindResourceDropdown(objResource_data.strResourceName1)
		.clickUpdateStatusInPopupWindow();
		
		objUpdateStatus_Page1.clickOnSelectAll()
		.enterNSTAndTSTUpdateValue(strStatusTypeValues[0],
				objView_data.strValueForUpdate2)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues[1],
				objView_data.strValueForUpdate2)
		.enterUpdateSSTValues(strStatusTypeValues[3],
				objView_data.strValueForSST2)
		.selectMSTUpdateValue(strStatusTypeValues[2],
				strStatusesValues[0])
		.enterNedocsUpdateValue(strStatusTypeValues[4],
				objView_data.strValueForNDST2)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues[5],
				objView_data.strDateUpdateFutureValue1)
				
		.enterNSTAndTSTUpdateValue(strStatusTypeValues1[0],
				objView_data.strValueForUpdate)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues1[1],
				objView_data.strValueForUpdate)
		.enterUpdateSSTValues(strStatusTypeValues1[3],
				objView_data.strValueForSST)
		.selectMSTUpdateValue(strStatusTypeValues1[2],
				strStatusesValues[1])
		.enterNedocsUpdateValue(strStatusTypeValues1[4],
				objView_data.strValueForNDST)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues1[5],
				objView_data.strDateUpdateValue)
				
		.enterNSTAndTSTUpdateValue(strStatusTypeValues2[0],
				objView_data.strValueForUpdate1)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues2[1],
				objView_data.strValueForUpdate1)
		.enterUpdateSSTValues(strStatusTypeValues2[3],
				objView_data.strValueForSST1)
		.selectMSTUpdateValue(strStatusTypeValues2[2],
				strStatusesValues[2])
		.enterNedocsUpdateValue(strStatusTypeValues2[4],
				objView_data.strValueForNDST1)
		.enterNSTAndTSTUpdateValue(strStatusTypeValues2[5],
				objView_data.strDateUpdateFutureValue).clickOnSaveButton();
		
		String strEventStartTime1 = objEventManagement1.getApplicationTimeWithCSTCDT();

		String strStartTime2[] = strEventStartTime1.split(":");
		
		String strStartTime3[] = strStartTime2[0].split(" ");

		String strDate3 = strStartTime3[0];

		String strMonth1 = strStartTime3[1];

		strMonth1 = objDts
				.converDateFormat(strMonth1, "MMM", "MM");

		strYear = objDts.getFutureYear(0, "yyyy");

		String strHour1	 = strStartTime3[2];

		String strMinute2 = strStartTime2[1];
		
		String strMin[] = strMinute2.split(" ");

		String strMinute3 = objDts.addTimetoExisting(strMinute2,
				2, "mm");

		String strCurrentDate1 = strMonth1 + "/" + strDate3 + "/" + strYear;

		String strTime1 = objDts.getCurrentDate("HH:mm");

		strCurrentDate1 = strCurrentDate1 + " " + strTime1;

		String[] strDate1 = strCurrentDate1.split(" ");

		System.out.println(strCurrentDate1);
		String strLastUpdatedDateInReport1 = objDts
				.converDateFormat(strCurrentDate1, "MM/dd/yyyy HH:mm",
						"dd MMM yyyy HH:mm");
		String str1[] = strLastUpdatedDateInReport1.split(" ");
		strLastUpdatedDateInReport1 = str1[0] + " " + str1[1] + " " + str1[2] + " "
				+ strHour + ":" + strMin[0];
		System.out.println(strLastUpdatedDateInReport1);
		
		objNavigationToSubMenus1.navigateToUsers();
		
		objUsersList1.enterUsernameInSearchInputField(objUser_data.strNewUserName)
		.clickSearchButton()
		.editUserDetails(objUser_data.strNewUserName)
		.clickRefineLinkOfViewResource(objResource_data.strResourceName)
		.selectFrameOfRefineVisibleStatusTypes()
		.deselectStatusTypesInRefine(strStatusTypeValues1)
		.deselectStatusTypesInRefine(strStatusTypeValues2)
		.clickSaveChangesButtonInRefine().selectFrame()
		.clickSaveButton();
		
		Thread.sleep(180000);
		objLogin1.clickLogOut();
		
		objLogin1.loginAsNewUser(objUser_data.strNewUserName,
						objUser_data.strNewPassword);
		
		objRegionDefault1.selectFrame();
		
		objNavigationToSubMenus1.clickOnStatusReports();
		
		TimeUnit.MINUTES.sleep(1);
		
		objReport1.clickOnStatusSnapshot().enterReportDate(strDate[0])
				.selectHour(strHour1).selectMinute(strMinute3)
				.clickOnGenerateReportBtn();

		objAutoIT.DownloadTheReports(strAutoItPath, strDownloadName,
				strAutoITName);
		
		int intCount = 0;
		int intCount1 = 0;
		do {

			try {
				assertTrue(new File(strDownloadName).exists());
				Thread.sleep(10000);
				Runtime.getRuntime().exec(
						"wscript " + autoItFiles + filePath + " "
								+ strCSVFileNameRenamed);

				intCount1 = 0;
				do {
					try {
						assertTrue(new File(strCSVDownlRenamedPath).exists());
						break;
					} catch (AssertionError Ae) {
						Thread.sleep(1000);
						intCount1++;
					}

				} while (intCount1 < 60);

				break;
			} catch (AssertionError Ae) {
				Thread.sleep(1000);
				intCount++;
			}
		} while (intCount < 60);
		
		String strValue = objOffCommonFunc.readInfoExcel(objReport_data.statusSnapshotsheetName, 1,
				1, strDownloadName1);
		assertEquals("Status Snapshot - " + strDate1[0] + " " + strHour1 + ":"
				+ strMinute3 + " "+strTimeZone[1]+"", strValue);

		int intRowCount = objOffCommonFunc.getRowsCountOfExceSheet(
				strDownloadName1, objReport_data.statusSnapshotsheetName);
		
		String[] strHeaderNames = objReport_data.strStatusSnapshot;
		
		for (int i = 1; i <= strHeaderNames.length; i++) {
			strValue = objOffCommonFunc.readInfoExcel(
					objReport_data.statusSnapshotsheetName, 2, i, strDownloadName1);
			assertEquals(strHeaderNames[i - 1], strValue);
		}

		String[] strAnswers = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatuTypes_data.strDateStatusTypeName,
				objView_data.strDateUpdateValue, "", strLastUpdatedDateInReport };
		
		String[] strAnswers1 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatuTypes_data.strMSTStatusTypeName,
				objStatuTypes_data.strStatusNameInMulti, "", strLastUpdatedDateInReport };
		
		String[] strAnswers2 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatuTypes_data.strNDSTStatusTypeName,
				objView_data.strNEDOCVal, "", strLastUpdatedDateInReport };
		
		String[] strAnswers3 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatuTypes_data.strNSTStatusTypeName,
				objView_data.strValueForUpdate, "", strLastUpdatedDateInReport };
		
		String[] strAnswers4 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatuTypes_data.strSSTStatusTypeName,
				objView_data.strUpdatedValForSST, "", strLastUpdatedDateInReport };
		
		String[] strAnswers5 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName,
				objStatuTypes_data.strTSTStatusTypeName,
				objView_data.strValueForUpdate, "", strLastUpdatedDateInReport };
		
		int intcnt = 0;
		for (int i = intRowCount; i <= intRowCount; i--) {
			if (i != 0) {
				strValue = objOffCommonFunc.readInfoExcel("Status Snapshot", i,
						2, strDownloadName1);
				if (strValue.contains(objResource_data.strResourceName)) {
					for (int j = 1; j <= strAnswers.length; j++) {
						strValue = objOffCommonFunc.readInfoExcel(
								objReport_data.statusSnapshotsheetName, i, j, strDownloadName1);
						assertTrue(strValue.contains(strAnswers[j - 1])
								|| strValue.contains(strAnswers1[j - 1])
								|| strValue.contains(strAnswers2[j - 1])
								|| strValue.contains(strAnswers3[j - 1])
								|| strValue.contains(strAnswers4[j - 1])
								|| strValue.contains(strAnswers5[j - 1]));
					}
					intcnt++;
				}
			}
			if (intcnt == 2)
				break;
		}
		
		String[] strAnswers6 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strDateStatusTypeName,
				objView_data.strDateUpdateFutureValue1, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers7 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strMSTStatusTypeName,
				objStatuTypes_data.strStatusNameInMulti, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers8 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strNDSTStatusTypeName,
				objView_data.strNEDOCValue4, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers9 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strNSTStatusTypeName,
				objView_data.strValueForUpdate2, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers10 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strSSTStatusTypeName,
				objView_data.strUpdatedValForSST2, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers11 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strTSTStatusTypeName,
				objView_data.strValueForUpdate2, "", strLastUpdatedDateInReport1 };
		
		
		String[] strAnswers12 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strDateStatusTypeName1,
				objView_data.strDateUpdateValue, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers13 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strMSTStatusTypeName1,
				objStatuTypes_data.strStatusNameInMulti1, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers14 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strNDSTStatusTypeName1,
				objView_data.strNEDOCVal, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers15 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strNSTStatusTypeName1,
				objView_data.strValueForUpdate, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers16 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strSSTStatusTypeName1,
				objView_data.strUpdatedValForSST, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers17 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strTSTStatusTypeName1,
				objView_data.strValueForUpdate, "", strLastUpdatedDateInReport1 };
		
		
		String[] strAnswers18 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strDateStatusTypeName2,
				objView_data.strDateUpdateFutureValue, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers19 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strMSTStatusTypeName2,
				objStatuTypes_data.strStatusNameInMulti2, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers20 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strNDSTStatusTypeName2,
				objView_data.strNEDOCValue1, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers21 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strNSTStatusTypeName2,
				objView_data.strValueForUpdate1, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers22 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strSSTStatusTypeName2,
				objView_data.strUpdatedValForSST1, "", strLastUpdatedDateInReport1 };
		
		String[] strAnswers23 = { objResourceType_data.strResourceTypeName,
				objResource_data.strResourceName1,
				objStatuTypes_data.strTSTStatusTypeName2,
				objView_data.strValueForUpdate1, "", strLastUpdatedDateInReport1 };
		
		
		int intcnt1 = 0;
		for (int i = intRowCount; i <= intRowCount; i--) {
			if (i != 0) {
				strValue = objOffCommonFunc.readInfoExcel(objReport_data.statusSnapshotsheetName, i,
						2, strDownloadName1);
				if (strValue.contains(objResource_data.strResourceName1)) {
					for (int j = 1; j <= strAnswers6.length; j++) {
						strValue = objOffCommonFunc.readInfoExcel(
								objReport_data.statusSnapshotsheetName, i, j, strDownloadName1);
						System.out.println(strValue);
						System.out.println(i);
						System.out.println(j);
						assertTrue(strValue.contains(strAnswers6[j - 1])
								|| strValue.contains(strAnswers7[j - 1])
								|| strValue.contains(strAnswers8[j - 1])
								|| strValue.contains(strAnswers9[j - 1])
								|| strValue.contains(strAnswers10[j - 1])
								|| strValue.contains(strAnswers11[j - 1])
								|| strValue.contains(strAnswers12[j - 1])
								|| strValue.contains(strAnswers13[j - 1])
								|| strValue.contains(strAnswers14[j - 1])
								|| strValue.contains(strAnswers15[j - 1])
								|| strValue.contains(strAnswers16[j - 1])
								|| strValue.contains(strAnswers17[j - 1])
								|| strValue.contains(strAnswers18[j - 1])
								|| strValue.contains(strAnswers19[j - 1])
								|| strValue.contains(strAnswers20[j - 1])
								|| strValue.contains(strAnswers21[j - 1])
								|| strValue.contains(strAnswers22[j - 1])
								|| strValue.contains(strAnswers23[j - 1]));
					}
					intcnt1++;
				}
			}
			if (intcnt1 == 18)
				break;
		}
		gstrResult = "PASS";
	}
	
	/*******************************************************************************
	'Description : Verify that the status snapshot report displays appropriate data for NEDOCS status type 
	'Date	 	 : 27-Dec-2015
	'Author		 : Renushree
	'-------------------------------------------------------------------------------
	'Modified Date			                        	Modified By
	'Date					                            Name
	********************************************************************************/
	@Test(description = "Verify that the status snapshot report displays appropriate data for NEDOCS status type ")
	public void testHappyDay119792() throws Exception {

		gstrTCID = "119792";
		gstrTO = "Verify that the status snapshot report displays appropriate data for NEDOCS status type ";

		Login_data objTest_data = new Login_data();
		User_data objUser_data = new User_data();
		Resource_data objResource_data = new Resource_data();
		StatusTypes_data objStatuTypes_data = new StatusTypes_data();
		View_data objView_data = new View_data();
		Roles_data objRoles_data = new Roles_data();
		Date_Time_settings objDts = new Date_Time_settings();
		Report_data objReport_data = new Report_data();
		ResourceType_data objResourceType_data = new ResourceType_data();

		PathsProperties objAP = new PathsProperties();
		Properties pathProps = objAP.ReadAutoit_FilePath();
		Date_Time_settings dts = new Date_Time_settings();
		String strPartialAutoResultsPath = Login_data.strPartialAutoResultsPath;
		OfficeCommonFunctions objOffCommonFunc = new OfficeCommonFunctions();

		String strTimeText = dts.getCurrentDate(objReport_data.dateFormat1);
		String fileType = objReport_data.reportFile;

		Login objLogin = new Login(this.driver1);
		SelectRegion objSelectRegion = new SelectRegion(this.driver1);
		RegionDefault objRegionDefault = new RegionDefault(this.driver1);
		StatusTypeList objStatusTypeList = new StatusTypeList(this.driver1);
		ResourceType objResourceType = new ResourceType(this.driver1);
		Resource objResource = new Resource(this.driver1);
		UsersList objUsersList = new UsersList(this.driver1);
		Roles objRoles = new Roles(this.driver1);
		ViewsList objViewsList = new ViewsList(this.driver1);
		NavigationToSubMenus objNavigationToSubMenus = new NavigationToSubMenus(
				this.driver1);

		Login objLogin1 = new Login(this.driver1);
		RegionDefault objRegionDefault1 = new RegionDefault(this.driver1);
		EventManagement objEventManagement1 = new EventManagement(this.driver1);
		NavigationToSubMenus objNavigationToSubMenus1 = new NavigationToSubMenus(
				this.driver1);
		Report objReport1 = new Report(this.driver1);
		ViewsList objViewsList1 = new ViewsList(this.driver1);
		AutoIT objAutoIT = new AutoIT(this.driver1);
		UpdateStatus objUpdateStatus_Page1 = new UpdateStatus(this.driver1);

		String strstatusTypeValues[] = new String[1];
		String strResourceValue[] = new String[1];
		String strResourceTypeValue[] = new String[1];
		String strRoleValue[] = new String[1];

		// Auto it path
		String AutoIT_FILE_PATH = objReport_data.reportsDownloadAutoItPath;
		String strAutoItPath = ReadAutoItProperty
				.readDataFromAutoItPath(AutoIT_FILE_PATH);
		String strAutoITName = pathProps
				.getProperty(objReport_data.reportsDownloadAutoItName);
		String fileDownloadPath = pathProps
				.getProperty(objReport_data.reportsDownloadPath);
		File file = new File(System.getProperty("user.dir") + fileDownloadPath);
		String strDownloadName = file + "\\" + "TC" + gstrTCID + "_"
				+ strTimeText + fileType;

		objLogin.loginToApplication(objTest_data.strUserName,
				objTest_data.strPassword);

		objSelectRegion.selectRegionAndNavigate(objTest_data.strRegionName);

		objRegionDefault.selectFrame();

		objStatusTypeList.navigateToStatusTypeList();

		// RoleBased statustypes
		objStatusTypeList.createStatusType(
				objStatuTypes_data.strNedocCalculationStatusType,
				objStatuTypes_data.strNDSTStatusTypeName,
				objStatuTypes_data.strStatusDescription);

		strstatusTypeValues[0] = objStatusTypeList
				.getStatusValue(objStatuTypes_data.strNDSTStatusTypeName);

		// Resource type creation
		objResourceType.navigateToResourceTypePage().createResourceType(
				objResourceType_data.strResourceTypeName, strstatusTypeValues);

		strResourceTypeValue[0] = objResourceType
				.getResourceTypeValue(objResourceType_data.strResourceTypeName);

		// create resource with address
		objResource.navigateToResourceListPage().createResourceWithAddress(
				objResource_data.strResourceName,
				objResource_data.strResourceAbbrivation,
				objResourceType_data.strResourceTypeName,
				objResource_data.strStandardResourceTypename,
				objResource_data.strResourceFirstName,
				objResource_data.strResourceLastName,
				objResource_data.strStreetAddress, objResource_data.strCity,
				objResource_data.strState, objResource_data.strCounty,
				objResource_data.strZipcode);

		strResourceValue[0] = objResource
				.getResourceValue(objResource_data.strResourceName);

		// Create role
		objNavigationToSubMenus.navigateToRoles();

		objRoles.createRole(objRoles_data.strRoleName);

		strRoleValue[0] = objRoles.getRoleValue(objRoles_data.strRoleName);

		objNavigationToSubMenus.navigateToViews();

		objViewsList.createView(objView_data.strViewName, objView_data.strViewDesc, objResource_data.strResourceName, objStatuTypes_data.strNDSTStatusTypeName);
		
//		objViewsList.clickCreateNewViewButton()
//				.enterViewName(objView_data.strViewName)
//				.enterViewDesc(objView_data.strViewDesc);
//
//		objViewsList.selectStatusType(objStatuTypes_data.strNDSTStatusTypeName);
//
//		objViewsList.selectResource(objResource_data.strResourceName)
//				.clickOnSaveOfCreateNewView();

		System.out.println(objView_data.strViewName);

		// User creation
		objUsersList
				.navigateToUsersNew()
				.clickCreateNewUserButton()
				.enterUserDetails(objUser_data.strNewUserName,
						objUser_data.strNewPassword, objUser_data.strFullName)
				.selectRoleCheckBox(strRoleValue)
				.clickAdvancedOptionAndExpand()
				.selectReportStatusSnapshotOption()
				.selectViewResourceCheckBox(objResource_data.strResourceName)
				.selectUpdateStatusOfResource(objResource_data.strResourceName)
				.selectRunReportsCheckBox(objResource_data.strResourceName)
				.clickSaveButton()
				.verifyUserListPageIsDisplayed();

		System.out.println(objUser_data.strNewUserName);

		objLogin.clickLogOut();

		System.out
				.println("-----Precondition ends and test execution starts-------");

		objLogin1.loginAsNewUser(objUser_data.strNewUserName,
				objUser_data.strNewPassword);

		objRegionDefault1.selectFrame();

		objNavigationToSubMenus1
				.navigateToParticularViewUnderViewMenu(objView_data.strViewName);

		objViewsList1.clickOnUpdateStatus(objResource_data.strResourceName);

		objUpdateStatus_Page1
				.enterNedocsUpdateValue(strstatusTypeValues[0],
						objView_data.strValueForNDST).clickOnSaveButton();

		String strUpdatedTime = objEventManagement1.getApplicationTime();

		String strTime[] = strUpdatedTime.split(" ");

		String strTime1 = strTime[0];

		String strTime2 = strTime[1];

		String strTime3 = strTime[2];

		String strDate = dts.timeNow("dd MMM yyyy");

		String strUpdateTime = strTime1 + " " + strTime2 + " " + strDate + " "
				+ strTime3;

		objUpdateStatus_Page1.verifyUpdatedStatusValues(strResourceValue[0],
				strstatusTypeValues[0], objView_data.strNEDOCValue);

		String strEventStartTime = objEventManagement1.getApplicationTime();

		String strStartTime[] = strEventStartTime.split(":");

		String strStartTime1[] = strStartTime[0].split(" ");

		String strHour = strStartTime1[2];

		String strMinute = strStartTime[1];
		
		strMinute = objDts.addTimetoExisting(strMinute, 1, "mm");

		String strCurrentDate = objDts.getCurrentDate("MM/dd/yyyy HH:mm");

		String strStartTime2[] = strCurrentDate.split(" ");

		strCurrentDate = strStartTime2[0];
		
		TimeUnit.MINUTES.sleep(1);

		objNavigationToSubMenus1.clickOnStatusReports();

		objReport1.clickOnStatusSnapshot().enterReportDate(strCurrentDate)
				.selectHour(strHour).selectMinute(strMinute)
				.clickOnGenerateReportBtn();

		objAutoIT.DownloadTheReports(strAutoItPath, strDownloadName,
				strAutoITName);

		File file1 = new File(strDownloadName);
		boolean strReportfile = file1.exists();

		objLogin1.clickLogOut();

		if (strReportfile) {
			String[] strTestDataForExcel = {
					"3821",
					Login_data.strBuildName,
					objUser_data.strNewUserName + "/"
							+ objUser_data.strNewPassword,
					objTest_data.strRegionName,
					objStatuTypes_data.strNDSTStatusTypeName,
					objResourceType_data.strResourceTypeName,
					objResource_data.strResourceName, "", "", "", "",
					objReport_data.ExternalIP, strDownloadName, strUpdateTime,
					"", objView_data.strNEDOCValue };

			objOffCommonFunc.writeResultData(strTestDataForExcel,
					strPartialAutoResultsPath, "CSVDetails");
		}
		if (strReportfile) {
			gstrResult = "PASS";
		} else {
			gstrResult = "FAIL";
		}
	}
}
